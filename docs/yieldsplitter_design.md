# YieldSplitter Design Document

## 1. Overview
YieldSplitter is a DeFi primitive for "Yield Stripping" on Solana. It allows users to deposit interest-bearing assets (like JitoSOL) and split them into:
-   **PT (Principal Token)**: Represents the 1:1 value of the underlying asset at maturity.
-   **YT (Yield Token)**: Represents the claim on all yield generated by the asset until maturity.

## 2. Financial Model

### 2.1 Tokenization
Given 1 `JitoSOL` worth `1.0 SOL` today and growing:
-   User deposits `1 JitoSOL`.
-   Protocol mints `1 PT-JitoSOL-DEC25` + `1 YT-JitoSOL-DEC25`.
-   At maturity (DEC25), `1 PT` is redeemable for `1 JitoSOL` (worth > 1 SOL).
-   `YT` holders can claim the accrued rewards periodically.

### 2.2 AMM Design (SY-PT)
To allow trading, we implement a specialized AMM adapted from YieldSpace or Notional Finance papers.
`constant_power_sum` invariant:
$$(x + y)^{t} = k$$
Where:
-   `t` = time to maturity.
-   This curve reduces slippage as `t` approaches 0 (maturity), forcing PT price to converge to 1.

## 3. Program Structure (Anchor)
-   `initialize_amm`: Create a new pool for a specific maturity.
-   `tokenize_yield`:
    -   **Input**: Amount of underlying (e.g., JitoSOL).
    -   **Output**: Mint equal amounts of PT and YT to user.
-   `swap`:
    -   **Input**: `amount_in` (e.g., PT), `min_out`.
    -   **Logic**: Execute trade against the Constant Power Sum invariant.

## 4. Integration
-   **SolFabric**: Used to execute arbitrage strategies between the YieldSplitter AMM and standard Spot markets (e.g., Orca/Raydium) to keep rates efficient.
-   **Oracles**: May require an oracle for the "Implied Rate" if using a dynamic fee model.
